/* ============================================================
   TIMELINE.CSS — Curseur temporel + Modal Filtres draggable
   ============================================================ */

/* ============================================================
   1. BOUTONS BAS-DROIT
   ============================================================ */

.bottom-controls {
    position: fixed;
    bottom: calc(28px + env(safe-area-inset-bottom));
    right: 25px;
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 10px;
    z-index: 1000;
    pointer-events: none;
}

.bottom-ctrl-btn {
    pointer-events: auto;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 7px;
    width: 120px;
    height: 36px;
    background: rgba(12, 12, 14, 0.75);
    border: 1px solid rgba(255, 255, 255, 0.13);
    color: rgba(255, 255, 255, 0.65);
    border-radius: 50px;
    cursor: pointer;
    font-family: 'Inter', sans-serif;
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    backdrop-filter: blur(14px);
    -webkit-backdrop-filter: blur(14px);
    box-shadow: 0 4px 18px rgba(0, 0, 0, 0.45);
    transition: all 0.25s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    white-space: nowrap;
}

.bottom-ctrl-btn svg {
    width: 13px;
    height: 13px;
    flex-shrink: 0;
    opacity: 0.8;
}

.bottom-ctrl-btn:hover {
    background: rgba(255, 255, 255, 0.12);
    border-color: rgba(255, 255, 255, 0.25);
    color: #fff;
    transform: translateY(-2px) scale(1.04);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.55);
}
.bottom-ctrl-btn:active { transform: scale(0.96); }

/* État actif — identique pour les deux */
.bottom-ctrl-btn.filter-btn--active,
.bottom-ctrl-btn.timeline-btn--active {
    background: rgba(255, 255, 255, 0.14);
    border-color: rgba(255, 255, 255, 0.4);
    color: #fff;
    box-shadow: 0 4px 18px rgba(0,0,0,0.5), 0 0 0 1px rgba(255,255,255,0.08);
}
.bottom-ctrl-btn.filter-btn--active svg,
.bottom-ctrl-btn.timeline-btn--active svg { opacity: 1; }

/* Pastille filtre actif */
.filter-dot {
    width: 5px; height: 5px;
    background: #fff;
    border-radius: 50%;
    display: none;
    flex-shrink: 0;
    margin-left: -2px;
}
.bottom-ctrl-btn.filter-btn--active .filter-dot { display: block; }


/* ============================================================
   2. PANNEAU TIMELINE
   ============================================================ */

#timeline-panel {
    position: fixed;
    bottom: 0; left: 0; right: 0;
    z-index: 999;
    padding: 0 28px calc(22px + env(safe-area-inset-bottom));
    background: linear-gradient(to top, rgba(0,0,0,0.90) 0%, transparent 100%);
    pointer-events: none;
    opacity: 0;
    transform: translateY(16px);
    transition: opacity 0.35s ease, transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
}
#timeline-panel.timeline-panel--visible {
    opacity: 1; transform: translateY(0); pointer-events: auto;
}

.timeline-inner { max-width: 580px; margin: 0 auto; display: flex; flex-direction: column; gap: 10px; }

.timeline-top-row { display: flex; align-items: center; justify-content: space-between; gap: 12px; }

#timeline-date-label { display: flex; flex-direction: column; gap: 1px; }

.timeline-date {
    font-family: 'Inter', sans-serif; font-size: 14px; font-weight: 600;
    color: #fff; text-shadow: 0 1px 6px rgba(0,0,0,0.6);
}
.timeline-count {
    font-family: 'Inter', sans-serif; font-size: 10px; font-weight: 400;
    color: rgba(255,255,255,0.45);
}

.timeline-controls { display: flex; align-items: center; gap: 8px; }

#timeline-play-btn {
    width: 34px; height: 34px; border-radius: 50%;
    background: rgba(255,255,255,0.12); border: 1px solid rgba(255,255,255,0.2);
    color: white; display: flex; align-items: center; justify-content: center;
    cursor: pointer; transition: all 0.2s ease;
}
#timeline-play-btn:hover { background: rgba(255,255,255,0.22); transform: scale(1.08); }
#timeline-play-btn svg { width: 13px; height: 13px; }
.icon-play  { display: block; }
.icon-pause { display: none; }
#timeline-play-btn.playing .icon-play  { display: none; }
#timeline-play-btn.playing .icon-pause { display: block; }

#timeline-close-btn {
    width: 34px; height: 34px; border-radius: 50%;
    background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.12);
    color: rgba(255,255,255,0.5); display: flex; align-items: center; justify-content: center;
    cursor: pointer; font-size: 18px; line-height: 1; transition: all 0.2s ease;
}
#timeline-close-btn:hover { color: #fff; background: rgba(255,255,255,0.15); transform: rotate(90deg) scale(1.08); }

.timeline-slider-row { display: flex; align-items: center; }

#timeline-slider {
    -webkit-appearance: none; appearance: none;
    width: 100%; height: 3px; border-radius: 3px; outline: none; cursor: pointer;
    --progress: 100%;
    background: linear-gradient(
        to right,
        rgba(255,255,255,0.85) 0%, rgba(255,255,255,0.85) var(--progress),
        rgba(255,255,255,0.15) var(--progress), rgba(255,255,255,0.15) 100%
    );
    transition: background 0.05s linear;
}
#timeline-slider::-webkit-slider-thumb {
    -webkit-appearance: none; width: 18px; height: 18px; border-radius: 50%;
    background: #fff; box-shadow: 0 2px 8px rgba(0,0,0,0.6); cursor: pointer;
    transition: transform 0.15s cubic-bezier(0.175, 0.885, 0.32, 1.5), box-shadow 0.15s ease;
}
#timeline-slider::-webkit-slider-thumb:hover { transform: scale(1.25); box-shadow: 0 4px 16px rgba(0,0,0,0.7); }
#timeline-slider::-moz-range-thumb {
    width: 18px; height: 18px; border-radius: 50%; background: #fff; border: none;
    box-shadow: 0 2px 8px rgba(0,0,0,0.6); cursor: pointer;
}


/* ============================================================
   3. MODAL FILTRES — Draggable
   ============================================================ */

#filters-modal {
    position: fixed;
    /* Positionné par JS au-dessus du bouton */
    bottom: 90px;
    right: 25px;
    width: 300px;
    z-index: 1001;
    background: rgba(15, 15, 15, 0.85);
    border-radius: 28px;
    border: 1px solid rgba(255, 255, 255, 0.12);
    box-shadow: 0 30px 70px rgba(0, 0, 0, 0.75);
    backdrop-filter: blur(25px) saturate(180%);
    -webkit-backdrop-filter: blur(25px) saturate(180%);
    opacity: 0;
    transform: scale(0.92) translateY(8px);
    pointer-events: none;
    transform-origin: bottom right;
    transition: opacity 0.25s ease, transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    user-select: none;
}

#filters-modal.filters-modal--visible {
    opacity: 1; transform: scale(1) translateY(0); pointer-events: auto;
}

/* ── État replié : seul le handle est visible ────────────────── */
#filters-modal.filters-modal--collapsed .filters-body,
#filters-modal.filters-modal--collapsed .filter-divider {
    display: none;
}

#filters-modal.filters-modal--collapsed {
    border-radius: 20px;
}

/* ── Handle / barre de titre ─────────────────────────────────── */
.filters-drag-handle {
    display: flex; align-items: center; justify-content: space-between;
    padding: 16px 18px 12px;
    cursor: grab;
    border-radius: 28px 28px 0 0;
}
.filters-drag-handle:active { cursor: grabbing; }

/* Quand replié, le handle occupe tout le modal */
#filters-modal.filters-modal--collapsed .filters-drag-handle {
    padding: 12px 16px;
    border-radius: 20px;
}

.filters-title {
    font-family: 'Inter', sans-serif; font-size: 15px; font-weight: 700;
    color: #fff; letter-spacing: -0.3px; pointer-events: none;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    max-width: 140px;
    transition: max-width 0.3s ease;
}

/* Quand replié : le titre affiche le résumé des filtres */
#filters-modal.filters-modal--collapsed .filters-title {
    max-width: 180px;
    font-size: 12px;
    font-weight: 500;
    color: rgba(255,255,255,0.75);
}

.filters-header-right { display: flex; align-items: center; gap: 7px; }

#filter-result-count {
    font-family: 'Inter', sans-serif; font-size: 10px; color: rgba(255,255,255,0.35);
}

/* Bouton Reset — hover neutre (blanc, pas rouge) */
#filters-reset-btn {
    background: rgba(255,255,255,0.06);
    border: 1px solid rgba(255,255,255,0.1);
    color: rgba(255,255,255,0.45);
    border-radius: 20px; padding: 3px 9px;
    font-size: 9px; font-weight: 600;
    font-family: 'Inter', sans-serif;
    text-transform: uppercase; letter-spacing: 0.4px;
    cursor: pointer; transition: all 0.2s ease;
}
#filters-reset-btn:hover {
    background: rgba(255, 255, 255, 0.12);
    border-color: rgba(255, 255, 255, 0.22);
    color: #fff;
}

/* Bouton collapse (^) */
#filters-collapse-btn {
    width: 26px; height: 26px; border-radius: 50%;
    background: rgba(255,255,255,0.07); border: 1px solid rgba(255,255,255,0.1);
    color: rgba(255,255,255,0.5);
    display: flex; align-items: center; justify-content: center;
    cursor: pointer; font-size: 13px; line-height: 1;
    transition: all 0.2s ease;
    flex-shrink: 0;
}
#filters-collapse-btn:hover { color: #fff; background: rgba(255,255,255,0.14); }

/* Rotation icône collapse selon état */
#filters-collapse-btn svg {
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}
#filters-modal.filters-modal--collapsed #filters-collapse-btn svg {
    transform: rotate(180deg);
}

#filters-close-btn {
    width: 26px; height: 26px; border-radius: 50%;
    background: rgba(255,255,255,0.07); border: 1px solid rgba(255,255,255,0.1);
    color: rgba(255,255,255,0.5);
    display: flex; align-items: center; justify-content: center;
    cursor: pointer; font-size: 15px; line-height: 1; transition: all 0.2s ease;
}
#filters-close-btn:hover { color: #fff; background: rgba(255,255,255,0.14); transform: rotate(90deg); }

/* ── Corps du modal ──────────────────────────────────────────── */
.filters-body {
    padding: 0 18px 18px; display: flex; flex-direction: column; gap: 12px;
    overflow: hidden;
    /* Animation repli */
    transition: all 0.3s ease;
}

.filter-section-label {
    font-family: 'Inter', sans-serif; font-size: 9px; font-weight: 700;
    letter-spacing: 1px; text-transform: uppercase; color: rgba(255,255,255,0.3);
    margin-bottom: 7px;
}

.filter-chips-row { display: flex; flex-wrap: wrap; gap: 6px; }

.filter-chip {
    background: rgba(255,255,255,0.07); border: 1px solid rgba(255,255,255,0.08);
    color: rgba(255,255,255,0.6); border-radius: 10px; padding: 5px 10px;
    font-family: 'Inter', sans-serif; font-size: 11px; font-weight: 600;
    cursor: pointer; transition: all 0.18s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    white-space: nowrap;
}
.filter-chip:hover {
    background: rgba(255,255,255,0.13); border-color: rgba(255,255,255,0.18);
    color: #fff; transform: translateY(-1px);
}
.filter-chip--active {
    background: #fff; border-color: transparent; color: #000; font-weight: 700;
}
.filter-chip--active:hover { background: rgba(255,255,255,0.88); color: #000; transform: translateY(-1px) scale(1.04); }
.filter-chip--pill { border-radius: 20px; padding: 5px 12px; }

.filter-divider { height: 1px; background: rgba(255,255,255,0.06); margin: 2px 0; }